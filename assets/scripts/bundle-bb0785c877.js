!function t(n,a,e){function o(r,s){if(!a[r]){if(!n[r]){var c="function"==typeof require&&require;if(!s&&c)return c(r,!0);if(i)return i(r,!0);var l=new Error("Cannot find module '"+r+"'");throw l.code="MODULE_NOT_FOUND",l}var u=a[r]={exports:{}};n[r][0].call(u.exports,function(t){var a=n[r][1][t];return o(a?a:t)},u,u.exports,t,n,a,e)}return a[r].exports}for(var i="function"==typeof require&&require,r=0;r<e.length;r++)o(e[r]);return o}({"/home/travis/build/openaq/aq-viz/app/assets/scripts/chart.js":[function(t,n,a){(function(n){"use strict";var a,e,o,i,r,s,c,l,u=t("./config"),p="undefined"!=typeof window?window.d3:"undefined"!=typeof n?n.d3:null,f=t("lodash"),d=t("async"),g=t("moment"),v=t("request"),m=400,h={top:38,right:28,bottom:72,left:84},q=2,y={},x=function(){p.select("svg").remove(),E(),b(),j(),z()};window.addEventListener("resize",x);var b=function(){o=p.time.scale.utc().range([0,a]),i=p.scale.linear().range([m,0]);var t,n;t=n=y[p.keys(y)[0]][0].date,f.forEach(y,function(a){f.forEach(a,function(a){a.date<t?t=a.date:a.date>n&&(n=a.date)})});var e,r;e=r=y[p.keys(y)[0]][0].value,f.forEach(y,function(t){f.forEach(t,function(t){t.value<e?e=t.value:t.value>r&&(r=t.value)})}),o.domain([t,n]),i.domain([e,1.1*r])},j=function(){r=p.svg.axis().scale(o).orient("bottom"),300>=a?r.ticks(3):600>=a&&r.ticks(6),s=p.svg.axis().scale(i).orient("left"),c=p.svg.line().x(function(t){return o(t.date)}).y(function(t){return i(t.value)})},z=function(){e.append("g").attr("class","x axis").attr("transform","translate(0,"+m+")").call(r).append("text").attr("transform","translate("+a/2+","+(h.bottom-25)+")").style("text-anchor","middle").text("Local Time"),e.append("g").attr("class","y axis").call(s).append("text").attr("transform","rotate(-90)").attr("y",-h.left).attr("x",-(m/2)).attr("dy","1em").style("text-anchor","middle").text("PM 2.5 (µg/m³)"),p.select("svg").selectAll(".circle-legend").data([{country:"china",y:20},{country:"india",y:50},{country:"mongolia",y:80}]).enter().append("circle").attr("fill-opacity","0").attr("stroke",function(t){switch(t.country){case"china":return"red";case"india":return"orange";case"mongolia":return"blue"}}).attr("cx",function(t){return a+h.left+h.right-110}).attr("cy",function(t){return t.y}).attr("r",10),p.select("svg").selectAll(".circle-text").data([{text:"Beijing",y:20},{text:"Delhi",y:50},{text:"Ulaanbaatar",y:80}]).enter().append("text").classed("circle-text",!0).attr("x",function(t){return a+h.left+h.right-96}).attr("y",function(t){return t.y+6}).attr("text-anchor","beginning").style("fill","#777").text(function(t){return t.text}),f.forEach(y,function(t){var n="india";"Beijing US Embassy"===t[0].location?n="china":("Tolgoit"===t[0].location||"Baruun 4 zam"===t[0].location)&&(n="mongolia"),e.append("path").datum(t).attr("class","line "+n).attr("d",c),e.selectAll(".point "+n).data(t).enter().append("svg:circle").attr("cx",function(t){return o(t.date)}).attr("cy",function(t){return i(t.value)}).classed(n,!0).classed("point",!0).attr("r",2).on("mouseover",l.show).on("mouseout",l.hide)})},w=function(){f.forEach(y,function(t){f.forEach(t,function(t){t.date=g(t.date.utc).subtract(g.parseZone(t.date.local).zone(),"minutes"),t.value=+t.value})})},E=function(){a=p.select(".chart").node().getBoundingClientRect().width,a=a-h.left-h.right,m=Math.round(a/q),e=p.select(".chart").append("svg").attr("width",a+h.left+h.right).attr("height",m+h.top+h.bottom).append("g").attr("transform","translate("+h.left+","+h.top+")"),l=p.tip().attr("class","d3-tip").offset([-10,0]).html(function(t){var n="<p><strong>Location:</strong> "+t.location+"</p><p><strong>Date:</strong> "+g.utc(t.date).format("Do MMM, YYYY, H:mm").toString()+"</p><p><strong>PM 2.5:</strong> "+t.value+" µg/m³</p>";return n}),e.call(l)},M=function(){var t=function(t){return function(n){var a=g().utc().subtract(2,"days").format("YYYY-MM-DD"),e=u.baseURL+"measurements?parameter=pm25&date_from="+a+"&location="+encodeURIComponent(t);v(e,function(a,e,o){a&&n(a);try{var i=JSON.parse(o)}catch(r){n(r)}0!==i.meta.found&&(y[t]=i.results),n(null)})}};d.parallel([t("Beijing US Embassy"),t("Mandir Marg"),t("Punjabi Bagh"),t("Tolgoit"),t("Baruun 4 zam")],function(t,n){return t?console.error(t):(E(),w(),b(),j(),void z())})};M()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./config":"/home/travis/build/openaq/aq-viz/app/assets/scripts/config.js",async:"async",lodash:"lodash",moment:"moment",request:"request"}],"/home/travis/build/openaq/aq-viz/app/assets/scripts/config.js":[function(t,n,a){var e={local:t("./config/local.js"),logo:t("./config/logo.js"),production:t("./config/production.js"),staging:t("./config/staging.js")},o=e.production,i=e.local||{};for(var r in o)n.exports[r]=o[r];for(var r in i)n.exports[r]=i[r]},{"./config/local.js":"/home/travis/build/openaq/aq-viz/app/assets/scripts/config/local.js","./config/logo.js":"/home/travis/build/openaq/aq-viz/app/assets/scripts/config/logo.js","./config/production.js":"/home/travis/build/openaq/aq-viz/app/assets/scripts/config/production.js","./config/staging.js":"/home/travis/build/openaq/aq-viz/app/assets/scripts/config/staging.js"}],"/home/travis/build/openaq/aq-viz/app/assets/scripts/config/local.js":[function(t,n,a){n.exports={}},{}],"/home/travis/build/openaq/aq-viz/app/assets/scripts/config/logo.js":[function(t,n,a){var e=["╭──────────────────────────────────────╮","│░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░│","│░░░░░░░░░░░░░░█░░░░░░░░░░░░░░░░░░░░░░░│","│░░░░░░░░░░░░░░░█░░█░░░░█░░░░░░░░░░░░░░│","│░░░░░░░░░░░░░░░██░░█░░██░░░░░░░░░░░░░░│","│░░░░░░░░░░░░░░░███░█░███░░░░░░░░░░░░░░│","│░░░░░░░░░░░░░░░███░████░░░░░░░░░░░░░░░│","│░░░░░░░░░░░░░░░███████░░░░░░█░░░█░░░░░│","│░░░░░░░░██░░░░░██████░░░░░██░░██░░░░░░│","│░░░░░█░░░██░░░░░█████░░░███░███░░░░░░░│","│░░░░░░██░░███░░░█████░░██████░░░░░░░░░│","│░░░░░░░░██░███░░█████░░████░░░░░░░░░░░│","│░░░░░░░░░██████░░████░███░░░░░░░░░░░░░│","│░░░░░░░░░░░░████░███░░█░░░░░░░░░░░░░░░│","│░░░░░░█████░░░░████░░░░░░░░░░░░░░░░░░░│","│░░░░░░░░██████░░░██░░░█░░░░░░░░░░░░░░░│","│░░░░░░░░░░░░████░█████░░░░░░░░░░░░░░░░│","│░░░░░░░░░░░░░░██████░░░░░░░░░░░░░░░░░░│","│░░░░░░░░░░░░░░░░░███░░░░░░░░░░░░░░░░░░│","╰──────────────────────────────────────╯"],o=[];e=e.map(function(t,n){return t.replace(/(^|[|│])|(░+)|(█+)/g,function(t,n,a,e){return n?(o.push("black"),"%c"+n):a?(o.push("#cf3f02"),"%c"+a):e||!t?(o.push("black"),"%c"+(e||"")):void 0})}).concat(["                                        ","%c           DEVELOPMENT SEED             "]).join("\n"),o=o.map(function(t){return"color: "+t}).concat(["color: #cf3f02; font-weight: bold"]),n.exports=[e].concat(o)},{}],"/home/travis/build/openaq/aq-viz/app/assets/scripts/config/production.js":[function(t,n,a){var e=t("./logo");n.exports={environment:"production",consoleMessage:e,baseURL:"https://api.openaq.org/v1/"}},{"./logo":"/home/travis/build/openaq/aq-viz/app/assets/scripts/config/logo.js"}],"/home/travis/build/openaq/aq-viz/app/assets/scripts/config/staging.js":[function(t,n,a){n.exports={environment:"staging"};var e=t("./production");for(var o in e)"undefined"==typeof n.exports[o]&&(n.exports[o]=e[o])},{"./production":"/home/travis/build/openaq/aq-viz/app/assets/scripts/config/production.js"}],"/home/travis/build/openaq/aq-viz/app/assets/scripts/main.js":[function(t,n,a){"use strict";var e=t("./config");t("./chart"),console.log.apply(console,e.consoleMessage),"staging"===e.environment&&console.log("STAGING")},{"./chart":"/home/travis/build/openaq/aq-viz/app/assets/scripts/chart.js","./config":"/home/travis/build/openaq/aq-viz/app/assets/scripts/config.js"}]},{},["/home/travis/build/openaq/aq-viz/app/assets/scripts/main.js"]);